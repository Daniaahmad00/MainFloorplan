<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Private Suite Occupancy Floorplan Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 text-gray-800 p-4 font-sans">
  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 max-w-7xl mx-auto px-4 md:px-6 lg:px-8 py-4">
    <!-- Left Panel -->
    <div class="col-span-1 bg-white p-6 rounded-2xl shadow-lg flex flex-col">
      <h1 class="text-2xl md:text-3xl font-bold text-orange-600 mb-4">
        PS Occupancy
        <span class="block text-sm md:text-lg font-medium text-gray-500 mt-1">
          Floorplan Dashboard
        </span>
      </h1>

      <!-- Filters -->
      <div class="space-y-4 mt-4 flex-1 overflow-auto">
        <div>
          <label class="block font-semibold mb-1 text-gray-700">Outlet</label>
          <select id="filter-outlet"
            class="w-full p-3 border border-gray-200 rounded-xl bg-gray-50 focus:outline-none focus:ring-2 focus:ring-orange-500">
          </select>
        </div>

        <div>
          <label class="block font-semibold mb-1 text-gray-700">Status</label>
          <select id="filter-status"
            class="w-full p-3 border border-gray-200 rounded-xl bg-gray-50 focus:outline-none focus:ring-2 focus:ring-orange-500">
          </select>
        </div>

        <div>
          <label class="block font-semibold mb-1 text-gray-700">Pax Size</label>
          <select id="filter-pax"
            class="w-full p-3 border border-gray-200 rounded-xl bg-gray-50 focus:outline-none focus:ring-2 focus:ring-orange-500">
          </select>
        </div>

        <div>
          <label class="block font-semibold mb-1 text-gray-700">Suite</label>
          <select id="filter-suite"
            class="w-full p-3 border border-gray-200 rounded-xl bg-gray-50 focus:outline-none focus:ring-2 focus:ring-orange-500">
          </select>
        </div>
      </div>

      <!-- Summary -->
      <div class="mt-6 bg-gray-50 rounded-xl border border-gray-200 p-4">
        <h2 class="text-lg font-semibold text-gray-700 mb-2">Metrics</h2>
        <table class="w-full text-sm">
          <tbody id="metrics-summary" class="divide-y divide-gray-200">
            <tr>
              <td class="py-2 text-gray-600">Occupied</td>
              <td class="py-2 text-right font-semibold text-red-600">0</td>
            </tr>
            <tr>
              <td class="py-2 text-gray-600">Available</td>
              <td class="py-2 text-right font-semibold text-green-600">0</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Right Panel -->
    <div class="col-span-2 bg-white rounded-2xl shadow-lg relative flex flex-col">
      <!-- Loading Spinner -->
      <div class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-90 z-50 hidden"
        id="loading-spinner">
        <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-orange-600 border-solid"></div>
      </div>

      <!-- Header -->
      <div class="p-4 border-b border-gray-200 flex justify-between items-center">
        <h2 class="text-xl font-semibold text-gray-700">Floorplan View</h2>
        <div class="space-x-2">
          <button class="bg-orange-500 text-white px-3 py-1.5 rounded-lg hover:bg-orange-600 text-sm">Download</button>
          <button class="bg-gray-100 px-3 py-1.5 rounded-lg hover:bg-gray-200 text-sm">Refresh</button>
        </div>
      </div>

      <!-- Floorplan Iframe -->
      <div class="flex-1 relative">
        <iframe id="floor-img" src="8FA/index.html" frameborder="0"
          class="w-full h-[calc(100vh-12rem)] rounded-b-2xl"></iframe>

        <!-- Zoom Controls -->
        <div class="absolute top-4 right-4 bg-white shadow-md rounded-lg flex flex-col overflow-hidden z-50">
          <button id="zoom-in" class="px-3 py-2 border-b hover:bg-orange-500 hover:text-white">+</button>
          <button id="zoom-out" class="px-3 py-2 border-b hover:bg-orange-500 hover:text-white">-</button>
          <button id="reset" class="px-3 py-2 hover:bg-orange-500 hover:text-white">Reset</button>
        </div>
      </div>
    </div>
  </div>


  <script src="main.js">
  </script>

  <script>
    // Zoom & Drag Controls for SVG inside <object>
    let scale = 1;
    let panX = 0, panY = 0;
    let isDragging = false;
    let startX, startY;
    let svgEl; // holds the <svg> element

    function initPanZoom() {
      const svgObj = document.getElementById("8FAFloorplan");

      svgObj.addEventListener("load", () => {
        const svgDoc = svgObj.contentDocument;
        svgEl = svgDoc.documentElement;

        svgEl.style.transformOrigin = "0 0";
        svgEl.style.transformBox = "fill-box";
        svgEl.style.cursor = "grab";

        // Zoom by mouse wheel
        svgDoc.addEventListener("wheel", (e) => {
          e.preventDefault();
          const zoomIntensity = 0.1;
          const oldScale = scale;
          scale += (e.deltaY < 0 ? zoomIntensity : -zoomIntensity);
          scale = Math.min(Math.max(0.5, scale), 3); // clamp between 0.5x and 3x

          // adjust pan so zoom focuses around cursor
          const rect = svgEl.getBoundingClientRect();
          const offsetX = e.clientX - rect.left;
          const offsetY = e.clientY - rect.top;
          panX -= (offsetX / oldScale - offsetX / scale);
          panY -= (offsetY / oldScale - offsetY / scale);

          applyTransform();
        });

        // Drag start
        svgDoc.addEventListener("mousedown", (e) => {
          isDragging = true;
          svgEl.style.cursor = "grabbing";
          startX = e.clientX - panX;
          startY = e.clientY - panY;
        });

        // Drag move
        svgDoc.addEventListener("mousemove", (e) => {
          if (!isDragging) return;
          panX = e.clientX - startX;
          panY = e.clientY - startY;
          applyTransform();
        });

        // Drag end
        svgDoc.addEventListener("mouseup", () => {
          isDragging = false;
          svgEl.style.cursor = "grab";
        });
        svgDoc.addEventListener("mouseleave", () => {
          isDragging = false;
          svgEl.style.cursor = "grab";
        });

        // Zoom buttons
        document.getElementById("zoom-in").addEventListener("click", () => {
          scale = Math.min(scale + 0.2, 3);
          applyTransform();
        });
        document.getElementById("zoom-out").addEventListener("click", () => {
          scale = Math.max(scale - 0.2, 0.5);
          applyTransform();
        });
        document.getElementById("reset").addEventListener("click", () => {
          scale = 1;
          panX = 0;
          panY = 0;
          applyTransform();
        });
      });
    }

    function applyTransform() {
      if (!svgEl) return;
      svgEl.style.transform = `translate(${panX}px, ${panY}px) scale(${scale})`;
    }

    // Initialize pan + zoom
    initPanZoom();
  </script>

</body>

</html>